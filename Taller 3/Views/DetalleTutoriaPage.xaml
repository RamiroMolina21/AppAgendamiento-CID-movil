<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Taller_3.ViewModels"
             xmlns:models="clr-namespace:Taller_3.Models"
             x:Class="Taller_3.Views.DetalleTutoriaPage"
             x:DataType="viewmodels:DetalleTutoriaViewModel"
             Title="Detalle de Tutoría"
             BackgroundColor="#E8F5E9">
    
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Volver" 
                     Command="{Binding Source={RelativeSource AncestorType={x:Type NavigationPage}}, Path=BackButtonCommand}"/>
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            <!-- Detalles de la tutoría -->
            <Border StrokeThickness="1" 
                    Stroke="#E0E0E0" 
                    BackgroundColor="White" 
                    Padding="20" 
                    StrokeShape="RoundRectangle 5,5,5,5">
                <VerticalStackLayout Spacing="15">
                    <Label Text="{Binding Tutoria.Tema}" 
                           FontSize="20" 
                           FontAttributes="Bold" 
                           TextColor="#2E7D32"/>
                    
                    <Label Text="{Binding Tutoria.Idioma, StringFormat='Idioma: {0}'}" 
                           FontSize="14" 
                           TextColor="#757575"/>
                    
                    <Label Text="{Binding Tutoria.Nivel, StringFormat='Nivel: {0}'}" 
                           FontSize="14" 
                           TextColor="#757575"/>
                    
                    <Label Text="{Binding Tutoria.Modalidad, StringFormat='Modalidad: {0}'}" 
                           FontSize="14" 
                           TextColor="#757575"/>
                    
                    <Label Text="{Binding Tutoria.FechaTutoria, StringFormat='Fecha: {0:dd/MM/yyyy HH:mm}'}" 
                           FontSize="14" 
                           TextColor="#757575"/>
                    
                    <Label Text="{Binding CuposTexto, StringFormat='Cupos: {0}'}" 
                           FontSize="14" 
                           TextColor="#757575"/>
                    
                    <Border BackgroundColor="#FF9800" 
                            StrokeThickness="0"
                            Padding="10,5"
                            StrokeShape="RoundRectangle 5,5,5,5"
                            HorizontalOptions="Start">
                        <Label Text="{Binding Tutoria.Estado}" 
                               TextColor="White"/>
                    </Border>
                </VerticalStackLayout>
            </Border>

            <!-- Estudiantes agendados -->
            <Border StrokeThickness="1" 
                    Stroke="#E0E0E0" 
                    BackgroundColor="White" 
                    Padding="20" 
                    StrokeShape="RoundRectangle 5,5,5,5">
                <VerticalStackLayout Spacing="15">
                    <HorizontalStackLayout>
                        <Label Text="Estudiantes Agendados" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               TextColor="#2E7D32"
                               HorizontalOptions="StartAndExpand"/>
                        <Button Text="+ Agregar" 
                                Command="{Binding AgregarEstudiantesCommand}"
                                BackgroundColor="#2E7D32" 
                                TextColor="White"
                                CornerRadius="5"
                                Padding="15,5"/>
                    </HorizontalStackLayout>

                    <CollectionView ItemsSource="{Binding Estudiantes}" 
                                    EmptyView="No hay estudiantes agendados.">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:UsuarioResponseDto">
                                <Border StrokeThickness="1" 
                                        Stroke="#E0E0E0" 
                                        BackgroundColor="#F5F5F5" 
                                        Padding="10" 
                                        Margin="0,0,0,5"
                                        StrokeShape="RoundRectangle 3,3,3,3">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="{Binding NombreCompleto}" 
                                               FontSize="14" 
                                               FontAttributes="Bold"
                                               TextColor="#424242"/>
                                        <Label Text="{Binding Correo}" 
                                               FontSize="12" 
                                               TextColor="#9E9E9E"/>
                                    </VerticalStackLayout>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
 